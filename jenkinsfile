
def projectGitRepo="https://github.com/akaish80/hello-world-jenkins"

pipeline {

 agent { node { label 'master' } }
    
    stages {

        stage("Cloning Git") {
            
            steps {
           sh "rm -Rf /opts/temp"

            sh "npm --version"
            echo "Arun -??? "
           echo "${env.BRANCH}"
           step([$class: "WsCleanup"])
           checkout([$class: "GitSCM", branches: [[name: "*/${params.BRANCH}"]], doGenerateSubmoduleConfigurations: false, extensions: [], submoduleCfg: [], userRemoteConfigs: [[credentialsId: "fbb51250db9df3680219ae3e15d3e7b783a98ad3", url: "${projectGitRepo}"]]])       
            }
       } 

         stage("Creating the version number") {
            steps {
                script {
                    echo "***************Creating the version number***************"
                    env_APPL_BUILD_NUMBER="${env.BUILD_ID}-${env.BUILD_TIMESTAMP}"
                    echo "${env_APPL_BUILD_NUMBER}"
                    
                    sh "echo ${getCommitId()}-${env_APPL_BUILD_NUMBER} >> ./.version"
                }
            }
         }

        stage("installing the packings & building the package") {
            steps {
                script {

                  echo "***************installing the packings & building the package ***************"
                    nodejs("Node-14.2.0_With_Yarn") {
                        sh "npm install"
                   }
                }
            }
          }
    }
}